INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:20:04.900365+02:00 (in 59.950250 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:20:04 CEST)" (scheduled at 2023-10-12 12:20:04.900365+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:21:04.900365+02:00 (in 59.774841 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:21:04 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 84, in run
    data = self.get_data()
           ^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 70, in get_data
    sql = self.make_query(device, 2023)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 41, in make_query
    month_query = f"(Max(CASE WHEN month(from_unixtime(ldr.date_record)) = '{month}' then ldr.{column_type}  END) - Min(CASE WHEN month(from_unixtime(ldr.date_record)) = '{month}' then ldr.{column_type}  END)) AS '{month}',"
                                                                             ^^^^^
UnboundLocalError: cannot access local variable 'month' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:22:03.125550+02:00 (in 59.973781 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:22:03 CEST)" (scheduled at 2023-10-12 12:22:03.125550+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:23:03.125550+02:00 (in 59.828496 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:23:03 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 92, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:23:53.104525+02:00 (in 59.974717 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:23:53 CEST)" (scheduled at 2023-10-12 12:23:53.104525+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:24:53.104525+02:00 (in 59.836834 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:24:53 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 92, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:25:37.848351+02:00 (in 59.981996 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:25:37 CEST)" (scheduled at 2023-10-12 12:25:37.848351+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:26:37.848351+02:00 (in 59.857631 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:26:37 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 92, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:27:37 CEST)" (scheduled at 2023-10-12 12:26:37.848351+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:27:37.848351+02:00 (in 59.766793 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:27:37 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 92, in run
    # Calculate difference between rows
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:27:46.605449+02:00 (in 59.973046 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:27:46 CEST)" (scheduled at 2023-10-12 12:27:46.605449+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:28:46.605449+02:00 (in 59.771071 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:28:46 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 93, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:32:54.639594+02:00 (in 59.981383 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:32:54 CEST)" (scheduled at 2023-10-12 12:32:54.639594+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:33:54.639594+02:00 (in 59.791756 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:33:54 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 93, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:34:54 CEST)" (scheduled at 2023-10-12 12:33:54.639594+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:34:54.639594+02:00 (in 59.880452 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:34:54 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 93, in run
    # Calculate difference between rows
                   ^^^^
UnboundLocalError: cannot access local variable 'data' where it is not associated with a value
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:35:27.116140+02:00 (in 59.973923 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:35:27 CEST)" (scheduled at 2023-10-12 12:35:27.116140+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:36:27.116140+02:00 (in 59.778242 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:36:27 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3790, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'celkova spotreba m3'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 93, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\frame.py", line 3896, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3797, in get_loc
    raise KeyError(key) from err
KeyError: 'celkova spotreba m3'
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:37:27 CEST)" (scheduled at 2023-10-12 12:36:27.116140+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:37:27.116140+02:00 (in 59.871028 seconds)
ERROR:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:37:27 CEST)" raised an exception
Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3790, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'celkova spotreba m3'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\apscheduler\executors\base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\src\gas_watcher.py", line 93, in run
    data['diff'] = data['celkova spotreba m3'].diff()
                   ~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\frame.py", line 3896, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\_Coding\customer-excel\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3797, in get_loc
    raise KeyError(key) from err
KeyError: 'celkova spotreba m3'
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:38:26.934779+02:00 (in 59.967953 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:38:26 CEST)" (scheduled at 2023-10-12 12:38:26.934779+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:39:26.934779+02:00 (in 59.747329 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:39:26 CEST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:40:26 CEST)" (scheduled at 2023-10-12 12:39:26.934779+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:40:26.934779+02:00 (in 59.814481 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:40:26 CEST)" executed successfully
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:40:51.890318+02:00 (in 59.970786 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:40:51 CEST)" (scheduled at 2023-10-12 12:40:51.890318+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:41:51.890318+02:00 (in 59.764173 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:41:51 CEST)" executed successfully
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:43:18.348043+02:00 (in 59.981052 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:43:18 CEST)" (scheduled at 2023-10-12 12:43:18.348043+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:44:18.348043+02:00 (in 59.824090 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:44:18 CEST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:45:18 CEST)" (scheduled at 2023-10-12 12:44:18.348043+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:45:18.348043+02:00 (in 59.811102 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:45:18 CEST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:46:18 CEST)" (scheduled at 2023-10-12 12:45:18.348043+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:46:18.348043+02:00 (in 59.849361 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:46:18 CEST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:47:18 CEST)" (scheduled at 2023-10-12 12:46:18.348043+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 12:47:18.348043+02:00 (in 59.866762 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: interval[0:01:00], next run at: 2023-10-12 12:47:18 CEST)" executed successfully
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Added job "GasWatcher.run" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 16:30:00+02:00 (in 1500.557932 seconds)
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: cron[minute='*/30'], next run at: 2023-10-12 16:30:00 CEST)" (scheduled at 2023-10-12 16:30:00+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 17:00:00+02:00 (in 1799.863822 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: cron[minute='*/30'], next run at: 2023-10-12 17:00:00 CEST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "GasWatcher.run (trigger: cron[minute='*/30'], next run at: 2023-10-12 17:30:00 CEST)" (scheduled at 2023-10-12 17:00:00+02:00)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2023-10-12 17:30:00+02:00 (in 1799.787429 seconds)
INFO:apscheduler.executors.default:Job "GasWatcher.run (trigger: cron[minute='*/30'], next run at: 2023-10-12 17:30:00 CEST)" executed successfully
